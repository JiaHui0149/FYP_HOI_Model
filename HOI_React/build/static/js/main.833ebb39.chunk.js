(this["webpackJsonpreact-website-tut"]=this["webpackJsonpreact-website-tut"]||[]).push([[0],{141:function(e,t,c){},142:function(e,t,c){},143:function(e,t,c){},146:function(e,t,c){},149:function(e,t,c){"use strict";c.r(t);var n=c(7),a=c.n(n),r=c(38),s=c.n(r),o=c(14),i=(c(87),c(0)),l=c.n(i),u=c(1),j=(c(89),c(53)),d=c(36),b=c(27),h={apiKey:"AIzaSyC-ffDdMn-HX7dnxHC-jrLf1EWFSwEkLY4",authDomain:"hoi-system.firebaseapp.com",projectId:"hoi-system",storageBucket:"hoi-system.appspot.com",messagingSenderId:"460144803322",appId:"1:460144803322:web:736c900f95ec5a1ee2b843",measurementId:"G-TCZS34CT32"},f=Object(j.a)(h),O=Object(d.b)(f),p=new d.a,v=(Object(b.d)(f),h),x=c(10);var m=function(){var e=Object(n.useState)([]),t=Object(o.a)(e,2),c=t[0],a=t[1],r=Object(n.useState)([]),s=Object(o.a)(r,2),i=s[0],j=s[1],d=Object(n.useState)([]),b=Object(o.a)(d,2),h=b[0],f=b[1];console.log("Authentication Information: ",O);var p=function(){var e=Object(u.a)(l.a.mark((function e(t,c){var n,a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n="/hoi/"+t,console.log("Endpoint: ",n),e.next=5,fetch(n);case 5:return a=e.sent,e.next=8,a.json();case 8:r=e.sent,console.log(r),c(r),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t,c){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){p("predictions",a)}),[]),Object(n.useEffect)((function(){p("videos",j)}),[]),Object(n.useEffect)((function(){p("aggressors",f)}),[]);var v={totalVideos:i.length,detectedIncidents:c.length,detectedAggressors:h.length};return Object(x.jsx)("div",{className:"home",children:Object(x.jsxs)("div",{className:"headerContainer",children:[Object(x.jsxs)("div",{className:"dataBox blue",children:[Object(x.jsx)("h1",{children:v.totalVideos}),Object(x.jsx)("p",{children:"Total Videos"})]}),Object(x.jsxs)("div",{className:"dataBox green",children:[Object(x.jsx)("h1",{children:v.detectedIncidents}),Object(x.jsx)("p",{children:"Detected Incidents"})]}),Object(x.jsxs)("div",{className:"dataBox orange",children:[Object(x.jsx)("h1",{children:v.detectedAggressors}),Object(x.jsx)("p",{children:"Detected Aggressors"})]})]})})},g=(c(91),Object(j.a)(v));var k=function(){var e=[Object(n.useRef)(null),Object(n.useRef)(null),Object(n.useRef)(null)],t=Object(n.useState)(0),c=Object(o.a)(t,2),a=c[0],r=c[1];Object(n.useEffect)((function(){function t(){return(t=Object(u.a)(l.a.mark((function t(){var c,n,r,s,o;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c=0;case 1:if(!(c<e.length)){t.next=28;break}if(n=e[c].current,c!==a||!n){t.next=24;break}return t.prev=4,t.next=7,navigator.mediaDevices.enumerateDevices();case 7:if(r=t.sent,!((s=r.filter((function(e){return"videoinput"===e.kind}))).length>c)){t.next=16;break}return t.next=12,navigator.mediaDevices.getUserMedia({video:{deviceId:s[c].deviceId}});case 12:o=t.sent,n.srcObject=o,t.next=17;break;case 16:console.log("No camera available for location ".concat(c));case 17:t.next=22;break;case 19:t.prev=19,t.t0=t.catch(4),console.error("Error accessing camera ".concat(c,":"),t.t0);case 22:t.next=25;break;case 24:n&&(n.srcObject=null);case 25:c++,t.next=1;break;case 28:case"end":return t.stop()}}),t,null,[[4,19]])})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[a]);var s=["Mall","Park","Street"],i=function(){var e=Object(u.a)(l.a.mark((function e(){var t,c,n,a,r,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=Object(b.d)(g),c=Object(b.b)(t,"Frames"),e.next=5,Object(b.c)(Object(b.g)(c,Object(b.f)("ID","desc"),Object(b.e)(1)));case 5:if((n=e.sent).empty){e.next=13;break}return a=n.docs[0],r=a.data().ID,s=(parseInt(r)+1).toString(),e.abrupt("return",s);case 13:return e.abrupt("return","100001");case 14:e.next=20;break;case 16:return e.prev=16,e.t0=e.catch(0),console.error("Error fetching and incrementing latest ID:",e.t0),e.abrupt("return","100001");case 20:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(){return e.apply(this,arguments)}}(),j=function(){var t=Object(u.a)(l.a.mark((function t(c){var n,r,o,u,j,d;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i();case 2:if(n=t.sent,r=e[c].current){t.next=7;break}return console.log("No video element found for location ".concat(c)),t.abrupt("return");case 7:return(o=document.createElement("canvas")).width=r.videoWidth,o.height=r.videoHeight,o.getContext("2d").drawImage(r,0,0,o.width,o.height),u=o.toDataURL("image/jpeg"),console.log("Captured frame for location ".concat(c,":"),u),t.prev=14,j=Object(b.d)(g),d=Object(b.b)(j,"Frames"),t.next=19,Object(b.a)(d,{ID:n,location:s[a],image:u,timestamp:Object(b.h)()});case 19:console.log("Frame for location ".concat(c," uploaded to Firestore with ID: ").concat(n)),t.next=25;break;case 22:t.prev=22,t.t0=t.catch(14),console.error("Error uploading frame to Firestore:",t.t0);case 25:case"end":return t.stop()}}),t,null,[[14,22]])})));return function(e){return t.apply(this,arguments)}}();return Object(n.useEffect)((function(){var e=setInterval((function(){j(a)}),5e3);return console.log("Frame capture interval started for location ".concat(a)),function(){clearInterval(e),console.log("Frame capture interval stopped for location ".concat(a))}}),[a]),Object(x.jsxs)("div",{className:"live",children:[Object(x.jsxs)("div",{className:"sidebar",children:[Object(x.jsx)("h2",{children:"Locations"}),Object(x.jsx)("ul",{children:s.map((function(e,t){return Object(x.jsx)("li",{className:a===t?"selected clickable":"clickable",onClick:function(){return function(e){r(e),console.log("Selected location changed to ".concat(s[e]))}(t)},children:e},t)}))})]}),Object(x.jsx)("div",{className:"live-container",children:Object(x.jsx)("div",{className:"live-content",children:Object(x.jsx)("div",{className:"live-video",children:e.map((function(e,t){return Object(x.jsx)("video",{ref:e,autoPlay:t===a,style:{transform:"scaleX(-1)",display:t===a?"block":"none"}},t)}))})})})]})},N=c(4),S=c(37),w=(c(92),function(e){var t=e.alert;return Object(x.jsxs)("div",{className:"alert-box",children:[Object(x.jsxs)("h3",{children:["Code ID: ",t.ID]}),Object(x.jsxs)("p",{children:["Last Appeared Location: ",t.location]}),Object(x.jsxs)("p",{children:["Last Appeared Time: ",t.timestamp]}),Object(x.jsxs)("div",{className:"image-container",children:[Object(x.jsx)("img",{src:t.image,alt:"CCTV",className:"image-fixed-size"}),Object(x.jsx)("img",{src:t.criminalDetected,alt:"",className:"larger-image"})]})]})}),I=c(76),y=c.n(I),C=(c(93),c(94),function(e){var t=e.filters,c=e.selectedFilters,n=e.onFilterChange;return Object(x.jsxs)("div",{className:"sidebar",children:[Object(x.jsx)("h2",{className:"sidebar-title",children:"Filters"}),Object(x.jsxs)("div",{className:"filter-section",children:[Object(x.jsx)("label",{children:"Date:"}),Object(x.jsx)(y.a,{selected:c.date?new Date(c.date):null,onChange:function(e){if(console.log("sidebardate",e),e){var t=e.getFullYear(),c=e.getMonth()+1,a=e.getDate(),r="".concat(t,"-").concat(c.toString().padStart(2,"0"),"-").concat(a.toString().padStart(2,"0"));console.log(r),n("date",r)}else n("date","")},dateFormat:"yyyy-MM-dd",isClearable:!0})]}),Object(x.jsxs)("div",{className:"filter-section",children:[Object(x.jsx)("label",{children:"Location:"}),Object(x.jsxs)("select",{value:c.location,onChange:function(e){var t=e.target.value;n("location",t)},children:[Object(x.jsx)("option",{value:"",children:"All"}),t.locations&&t.locations.length>0&&t.locations.map((function(e){return Object(x.jsx)("option",{value:e,children:e},e)}))]})]})]})});var D=function(){var e=Object(n.useState)([]),t=Object(o.a)(e,2),c=t[0],a=t[1],r=Object(n.useState)({dates:[],locations:[]}),s=Object(o.a)(r,2),i=s[0],j=s[1],d=Object(n.useState)({date:"",location:""}),b=Object(o.a)(d,2),h=b[0],f=b[1],O=function(){var e=Object(u.a)(l.a.mark((function e(){var t,c,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,"/hoi/frames",e.next=4,fetch("/hoi/frames");case 4:return t=e.sent,e.next=7,t.json();case 7:c=e.sent,console.log("DATA",c),n=c.filter((function(e){var t=!h.date||p(e.timestamp)===h.date,c=!h.location||e.location===h.location;return t&&c})),a(n),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}(),p=function(e){var t=new Date(e),c=t.getFullYear(),n=(t.getMonth()+1).toString().padStart(2,"0"),a=t.getDate().toString().padStart(2,"0");return"".concat(c,"-").concat(n,"-").concat(a)};return Object(n.useEffect)((function(){var e=function(){var e=Object(u.a)(l.a.mark((function e(){var t,c,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,"/hoi/location",e.next=4,fetch("/hoi/location");case 4:return t=e.sent,e.next=7,t.json();case 7:c=e.sent,console.log(c),n=c.map((function(e){return e.location_name})),j(Object(S.a)(Object(S.a)({},i),{},{locations:n})),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.error("Error fetching filter options:",e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}();O(),e()}),[]),Object(n.useEffect)((function(){O(),console.log(h)}),[h]),Object(x.jsxs)("div",{className:"alerts",children:[Object(x.jsx)("div",{className:"sidebar",children:Object(x.jsx)(C,{filters:i,selectedFilters:h,onFilterChange:function(e,t){f((function(c){return Object(S.a)(Object(S.a)({},c),{},Object(N.a)({},e,t))}))}})}),Object(x.jsxs)("div",{className:"alert-list",children:[Object(x.jsx)("h2",{children:"Past Alerts"}),0===c.length?Object(x.jsx)("p",{children:"No records found."}):c.map((function(e,t){return Object(x.jsx)(w,{alert:e},t)}))]})]})},E=(c(141),c(80));c(142);var F=function(e){var t=e.message,c=Object(n.useState)(!1),a=Object(o.a)(c,2),r=a[0],s=a[1];return Object(n.useEffect)((function(){if(t){s(!0);var e=setTimeout((function(){s(!1)}),5e3);return function(){return clearTimeout(e)}}}),[t]),Object(x.jsx)("div",{className:"notification ".concat(r?"show":""),children:Object(x.jsx)("div",{className:"notification-content",children:t})})};var A=function(e){var t=e.setAuthenticated,c=Object(n.useState)(""),a=Object(o.a)(c,2),r=a[0],s=a[1],i=Object(n.useState)(""),j=Object(o.a)(i,2),b=j[0],h=j[1],f=Object(n.useState)(!1),v=Object(o.a)(f,2),m=v[0],g=v[1],k=Object(n.useState)(null),N=Object(o.a)(k,2),S=N[0],w=N[1];console.log(O);var I=function(){var e=Object(u.a)(l.a.mark((function e(){var c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,g(!0),w(null),e.next=5,Object(d.c)(O,r,b);case 5:c=e.sent,c.user,t(!0),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),w("Invalid Password or Userame");case 13:return e.prev=13,g(!1),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[0,10,13,16]])})));return function(){return e.apply(this,arguments)}}(),y=function(){var e=Object(u.a)(l.a.mark((function e(){var c,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,g(!0),w(null),e.next=5,Object(d.d)(O,p);case 5:c=e.sent,n=c.user,t(!0),console.log(n),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),w(e.t0.message);case 14:return e.prev=14,g(!1),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[0,11,14,17]])})));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){O.currentUser&&t(!0)}),[t]),Object(x.jsxs)("div",{className:"auth-container",children:[Object(x.jsxs)("div",{className:"auth-form",children:[Object(x.jsx)("h2",{children:"Welcome to Our Dashboard"}),Object(x.jsx)("input",{type:"email",placeholder:"Email",value:r,onChange:function(e){return s(e.target.value)}}),Object(x.jsx)("input",{type:"password",placeholder:"Password",value:b,onChange:function(e){return h(e.target.value)}}),Object(x.jsx)("button",{className:"auth-button",onClick:I,disabled:m,children:m?"Signing In...":"Sign In"}),Object(x.jsxs)("button",{className:"auth-google-button",onClick:y,disabled:m,children:[Object(x.jsx)(E.a,{className:"google-icon"})," Sign In With Google"]})]}),S&&Object(x.jsx)("div",{className:"notification-container",children:Object(x.jsx)(F,{message:S})})]})},L=c.p+"static/media/logo.25c621ef.jpg",M=c(19),T=c(33);var P=function(e){var t=e.history,c=function(){var e=Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Attempting to log out..."),e.prev=1,e.next=4,Object(d.e)(O);case 4:console.log("Successfully logged out"),localStorage.setItem("authenticated","false"),t.push("/auth"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error("Error signing out:",e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}();return Object(x.jsx)("button",{className:"logout-button",onClick:c,children:"Log Out"})};c(143);var B=function(){var e=Object(n.useState)(!1),t=Object(o.a)(e,2),c=t[0],a=(t[1],Object(M.g)());return Object(x.jsxs)("div",{className:"navbar",children:[Object(x.jsxs)("div",{className:"leftSide",id:c?"open":"close",children:[Object(x.jsx)("img",{src:L}),Object(x.jsx)(T.b,{to:"/",children:" Main "}),Object(x.jsx)(T.b,{to:"/live",children:" Live "}),Object(x.jsx)(T.b,{to:"/alerts",children:" Alerts "}),Object(x.jsxs)("div",{className:"hiddenLinks",children:[Object(x.jsx)(T.b,{to:"/",children:" Main "}),Object(x.jsx)(T.b,{to:"/live",children:" Live "}),Object(x.jsx)(T.b,{to:"/alerts",children:" Alerts "}),Object(x.jsx)(T.b,{to:"/home",children:" Contact "})]})]}),Object(x.jsx)("div",{className:"rightSide"}),Object(x.jsx)(P,{history:a})]})};c(146);var R=function(){var e=Object(n.useState)(!1),t=Object(o.a)(e,2),c=t[0],a=t[1];return Object(n.useEffect)((function(){"true"===localStorage.getItem("authenticated")&&a(!0)}),[]),Object(x.jsx)("div",{className:"App",children:Object(x.jsx)(T.a,{children:Object(x.jsxs)(M.d,{children:[Object(x.jsx)(M.b,{path:"/auth",children:c?Object(x.jsx)(M.a,{to:"/"}):Object(x.jsx)(A,{setAuthenticated:a})}),Object(x.jsxs)(M.b,{children:[Object(x.jsx)(B,{}),Object(x.jsxs)(M.d,{children:[Object(x.jsx)(M.b,{path:"/",exact:!0,component:m}),Object(x.jsx)(M.b,{path:"/live",exact:!0,component:k}),Object(x.jsx)(M.b,{path:"/alerts",exact:!0,component:D})]})]})]})})})},U=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,157)).then((function(t){var c=t.getCLS,n=t.getFID,a=t.getFCP,r=t.getLCP,s=t.getTTFB;c(e),n(e),a(e),r(e),s(e)}))};s.a.render(Object(x.jsx)(a.a.StrictMode,{children:Object(x.jsx)(R,{})}),document.getElementById("root")),U()},87:function(e,t,c){},89:function(e,t,c){},91:function(e,t,c){},92:function(e,t,c){},94:function(e,t,c){}},[[149,1,2]]]);
//# sourceMappingURL=main.833ebb39.chunk.js.map